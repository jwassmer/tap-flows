
\documentclass[twocolumn,english,groupedaddress, superscriptaddress,aps,pre,10pt,floatfix]{revtex4-2}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amsthm,mathtools,amssymb}
\usepackage{graphicx}
\usepackage{units}
%\usepackage{dsfont}
\usepackage{xcolor}
\usepackage{soul}
\usepackage{changes}
\usepackage{xcolor} % for color
\usepackage{natbib} %citations
\bibliographystyle{unsrtnat}
\usepackage{epigraph}
\usepackage{hyperref}

\usepackage[capitalise]{cleveref}

\usepackage{url}
\usepackage{bbold} % for  Identity Matrix
\def\UrlBreaks{\do\/\do-\do_}


\newtheorem{lemma}{Lemma}
\newtheorem{thm}{Theorem}
\newtheorem{claim}{Claim}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}[section]



\newcommand{\matr}[1]{{\boldsymbol{#1}}}
\renewcommand{\vec}[1]{{\boldsymbol{#1}}}
\newcommand{\EE}{\mathfrak{E}}
\newcommand{\VV}{\mathfrak{V}}
\newcommand{\CC}{\mathfrak{C}}
\newcommand{\OO}{\mathcal{F}}
\newcommand{\eye}{\mathds{1}}
\newcommand{\LL}{\mathcal{L}}



%new commands
\newcommand{\jonas}[1]{%
  %\phantom{#1} %hide instead
  \sethlcolor{cyan}%
  \emph{\hl{[JW: #1]}}
}
\newcommand{\carsten}[1]{%
  %\phantom{#1} %hide instead
  \sethlcolor{red}%
  \emph{\hl{[CH: #1]}}
}
\newcommand{\FF}{\mathcal{F}}



\begin{document}

\title{A Social-Cost Sensitivity Centrality for Traffic Networks}

\author{Jonas Wassmer}
\affiliation{Potsdam Institute for Climate Impact Research (PIK), Member of the Leibniz Association, Potsdam, Germany}
\affiliation{Institute of Physics and Astronomy, University of Potsdam, Potsdam, Germany}
\author{Nils Antary}
\affiliation{Potsdam Institute for Climate Impact Research (PIK), Member of the Leibniz Association, Potsdam, Germany}
\author{Carsten Hartmann}
\affiliation{Forschungszentrum Jülich, Institute of Energy and Climate Research
– Energy System Engineering (ICE-1), 52428 Jülich, Germany}
%\author{Dirk Witthaut}
%\affiliation{Institute of Energy and Climate Research – Energy Systems Engineering (IEK-10), Forschungszentrum Jülich, 52428 Jülich, Germany}
\author{Norbert Marwan}
\affiliation{Potsdam Institute for Climate Impact Research (PIK), Member of the Leibniz Association, Potsdam, Germany}
\affiliation{Institute of Physics and Astronomy, University of Potsdam, Potsdam, Germany}


\begin{abstract}
Urban road networks are prototypical complex systems in which large numbers of individual agents interact through shared infrastructure, giving rise to collective traffic equilibria. These equilibria emerge from decentralized route choice decisions and exhibit a strong sensitivity to local changes in network properties. Even small modifications to the capacity or free-flow travel time of a single link can trigger large-scale reconfigurations of traffic flows, as illustrated by the Braess paradox. Conventional measures of link importance often overlook this systemic sensitivity and its implications for network efficiency. In this study, we introduce a social cost-based centrality measure that quantifies the marginal impact of link-level free-flow travel time perturbations on total social cost under Wardrop equilibrium. The measure is derived analytically from the linear formulation of the traffic assignment problem, enabling efficient and interpretable computation of local sensitivities on fixed active-support subgraphs (and thus piecewise-linear behavior across regime changes). We demonstrate the approach in synthetic and real-world urban networks, revealing structurally critical links that exert disproportionate influence on travel costs. Beyond improving network efficiency, this framework supports targeted interventions that can reduce unnecessary travel, lower emissions, and contribute to the transition toward more sustainable and livable cities.
\end{abstract}

\maketitle

\section{Introduction}

Traffic patterns in cities emerge from many local route choices made on shared road infrastructure rather than from centralized coordination. This decentralized interaction between heterogeneous drivers produces macroscopic states such as congestion patterns and traffic equilibria, making road systems a paradigmatic setting for self-organization in complex systems \citep{helbing2001traffic, nagel1992cellular, kerner2004physics, chowdhury2000statistical, helbing2009pedestrian}.

The behavior of such systems is governed by the emergence of macroscopic order from microscopic interactions. Through cooperative behavior, simple components can give rise to pattern formation, phase transitions, and system-wide stability \citep{haken1989,camazine2001}. In traffic networks, local route choices aggregate into collective flow patterns and systemic vulnerabilities. The importance of individual roads is therefore not determined by their physical properties alone, but by their role in shaping the global organization of flows. Identifying which local components exert the greatest influence on system-wide behavior is essential for understanding, predicting, and managing these self-organizing dynamics.

A defining feature of these networks is their sensitivity to local perturbations. Even small interventions, such as modifying the capacity or free-flow travel time of a single link, can trigger large-scale reconfigurations of traffic flows. The Braess paradox illustrates this sensitivity: adding a road can paradoxically increase total travel times by shifting route choices \citep{braess1968paradoxon, roughgarden2002bad, steinberg1983prevalence}. This demonstrates that transport network performance must be understood as a systemic property, rather than a simple sum of link-level characteristics.

Wardrop \citep{wardrop1952road} formulated two fundamental principles of traffic assignment. The \emph{user equilibrium} describes the state in which no driver can reduce their travel time by unilaterally changing routes, while the \emph{system optimum} minimizes total travel time across all users. The gap between these two states reflects the inefficiency of decentralized decision-making, often quantified as the price of anarchy \citep{roughgarden2002bad, correa2008geometric, youn2008price}. Understanding how local infrastructure changes influence these efficiency gaps remains a central challenge in network science and transport research.

Previous work has addressed traffic equilibria \citep{sheffi1985urban, patriksson1994traffic, florian1995network, smith1979existence}, equilibrium algorithms \citep{leblanc1975efficient, bargera2002origin, dial2006path}, link removal and capacity management \citep{nagurney2000emission, nagurney2009efficiency, xu2018critical, jenelius2006importance}, and paradoxical network effects \citep{zhang1997stability, pas1997braess, zhang2018braess}. Yet, systematic and scalable methods for quantifying how marginal changes to individual links affect overall network performance are still limited. Identifying critical and paradoxical edges through edge-impact analysis can provide valuable guidance for infrastructure management and policy \citep{passacantando2021braess, xu2018critical}.

\subsection{Motivation and contribution}

Many cities face the dual challenge of mitigating congestion while reducing emissions and reclaiming public space from car traffic \citep{newman2015end, cervero2013transport, creutzig2015transport}. Expanding road capacity has long been a standard response, but this strategy often induces additional traffic and fails to improve long-term performance \citep{downs1962law, duranton2011fundamental}. The Braess paradox provides a theoretical basis for why more capacity does not always lead to better outcomes. Addressing this challenge requires tools that can identify the network elements with the greatest systemic impact and thereby support targeted interventions such as congestion pricing, access restrictions, or adaptive signal control \citep{yang2005roadpricing, small2007economics, depalma2011congestion}.

To this end, we introduce \emph{social cost gradient centrality} (SCGC), a novel edge importance measure that quantifies how marginal changes in free-flow travel times affect total social cost. SCGC highlights both critical links that strongly influence system efficiency and Braessian links whose improvement would paradoxically worsen it.

The main contributions of this paper are:
\begin{enumerate}
    \item a closed-form matrix formulation of static traffic assignment with linear cost functions, showing that total social cost is piecewise linear in free-flow travel times,
    \item the definition of SCGC, unifying the detection of critical and paradoxical edges within a single framework,
    \item applications to synthetic and real-world urban networks, demonstrating how self-organized traffic patterns emerge from the interplay of network topology, user behavior, and link characteristics. 
\end{enumerate}

\subsection{Structure of the paper}

The remainder of this paper is structured as follows. Section~\ref{sec:model} reviews the traffic assignment model and the underlying cost function. We also revisit the Braess paradox and present an extended formulation. Section~\ref{sec:methods-solve} derives the SCGC measure analytically. Section~\ref{sec:results} applies the method to synthetic and real-world networks. Section~\ref{sec:discussion} discusses policy implications, emphasizing the identification of structurally important and paradoxical links, and concludes with an outlook on future research directions.

%\todo[inline]{here is a suggestion for linking it to Haken's work:}
%
%In understanding complex systems, the framework of synergetics, introduced 
%by Hermann Haken, emphasizes how macro-level order and patterns emerge 
%from the interactions of numerous simple, local components \cite{haken1983,haken1987}. 
%Haken's approach posits that systems self-organise through the cooperative 
%behavior of their constituents, leading to phenomena such as pattern formation, 
%phase transitions, and systemic stability-concepts that have found broad 
%application across physics, biology, and social sciences \cite{haken1989,kirkaldy1992,camazine2001}. Applying this 
%perspective to traffic networks, we recognize that the collective decisions 
%of individual drivers, while seemingly autonomous, give rise to emergent 
%traffic flow patterns, congestion hotspots, and systemic vulnerabilities. 
%The systemic importance of roads -- beyond their physical attributes -- can, 
%thus, be viewed as a manifestation of this self-organizing behavior, where 
%local interactions produce global effects. In this context, new measures like the 
%social cost-based centrality we propose serve to identify critical edges 
%that significantly influence the system's overall dynamics, aligning with 
%the synergetic principle that holistic behavior stems from micro-level 
%interactions \cite{haken1989}.




\section{Theory: Traffic modelling}\label{sec:model}

\subsection{Cost function}

Transportation networks are naturally modeled as directed graphs $G = (V,E)$, where edges $e \in E \subseteq V \times V$ represent road segments and nodes $n \in V$ represent intersections.
If a road between two intersections $n$ and $m$ has lanes in opposite directions, both edges $e=(n,m)$ and $e=(m,n)$ belong to the edge set $E$.\\

%In transportation networks, roads are modeled as a set of directed edges, $e \in E$, and their intersections or junctions as nodes, $i \in V$, in a graph $G(V,E)$.\\


To analyze the traffic flow $f_e \geq 0$ on a given road segment $e$, we define a cost function $t_e(f_e)$ that represents travel time as a function of both traffic volume and road capacity. Under the assumption that drivers follow basic traffic rules (e.g., matching the speed of the vehicle ahead, obeying speed limits, and maintaining a minimum speed), travel time is often modeled using the `Bureau of Public Roads' (BPR) formulation~\cite{us1964traffic}:
\begin{align}
\label{eq:bpr_general}
t_e^{(k)}(f_e) = \beta_e \left(1 + \alpha_e f_e^k \right),
\end{align}
where $\beta_e$ is the free-flow travel time, $\alpha_e$ is a parameter that captures how sensitively travel time reacts to congestion, and $k$ determines the degree of nonlinearity in the relationship.

In this work, we focus on the linear approximation of~\cref{eq:bpr_general} (i.e., $k = 1$), which simplifies the travel time function to 
\begin{align}\label{eq:linear-travel-time}
t_e(f_e)=\alpha_e f_e+\beta_e,\quad t_e(f_e)\in[t_e^0,t_e^{\mathrm{max}}].
\end{align}
The lower bound $t_e^0$ corresponds to the free-flow travel time determined by the road speed limit, whereas the upper bound $t_e^{\mathrm{max}}$ is set by walking-speed travel time under extreme congestion.



\subsection{Traffic equilibria and social cost}
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.5\textwidth]{assets/fig-social-optimum-user-eq.pdf}
    \caption{Traffic flows $f_e$ in a simple network where $10$ drivers travel from node $A$ to node $D$ under two routing regimes: \textbf{(a)} user equilibrium, where each driver minimizes their individual travel time, and \textbf{(b)} social optimum, where the total system travel time is minimized. The congestion parameter is set to $\alpha_e = 1$ for all edges. The free-flow travel times are given by $\beta_{AB}=0$, $\beta_{AC}=10$, $\beta_{BD}=10$, $\beta_{BC}=1$, and $\beta_{CD}=0$.}
    \label{fig:user-eq-optimum}
\end{figure}

%We further define the total \textit{social cost} of the system as the total flow multiplied by the travel time of each vehicle, summed over all edges in the network, 
%\begin{align}\label{eq:social-cost}
%    sc(f_e) = \sum_{e\in E} f_e t_e(f_e).
%\end{align}
%This represents the total travel time experienced by all drivers, reflecting the collective burden of congestion and delays in the system.\\

%The discrepancy between the social optimum and the user equilibrium flow is an example of the price of anarchy~\cite{koutsoupias1999worst}, which measures how the efficiency of a system degrades due to the selfish behavior of its agents.
We analyze traffic dynamics by modeling each driver as a rational agent seeking to minimize travel time between a given origin and destination. We further assume that drivers have perfect, real-time knowledge of traffic conditions, effectively implying universal GPS usage. These assumptions lead to the concept of a user equilibrium: a state in which no driver can reduce travel time by unilaterally changing routes. This principle, also known as Wardrop's first principle~\cite{wardrop1952road}, implies that all used routes between an origin--destination pair have equal and minimal travel times, while unused routes have higher travel times. The resulting traffic pattern satisfies the conditions of a Nash equilibrium in a network game among travelers~\cite{koutsoupias1999worst, roughgarden2002bad}.

While the user equilibrium represents an individually optimal state, it does not necessarily minimize overall congestion. In contrast, if routing is coordinated to minimize total travel time across the entire network (i.e., the social cost in \cref{eq:social-cost}),
\begin{align}\label{eq:social-cost}
SC(f_e) = \sum_{e\in E} f_e t_e(f_e),
\end{align}
the system reaches a system optimum---a state in which traffic is distributed to maximize overall efficiency. This principle, also known as Wardrop's second principle~\cite{wardrop1952road}, yields an allocation in which some drivers may experience longer travel times than in user equilibrium, but total congestion and aggregate delay are minimized.

The discrepancy between social cost at user equilibrium and at system optimum highlights inefficiencies introduced by selfish routing. This inefficiency is captured by the price of anarchy~\cite{koutsoupias1999worst}, which quantifies how strongly uncoordinated behavior degrades overall performance. In \cref{fig:user-eq-optimum}, we compare traffic flows $f_e$ in a simple network where $10$ drivers travel from node $A$ to node $D$ under (a) user equilibrium and (b) system optimum. In user equilibrium, each driver chooses routes to minimize individual travel time. In system optimum, routing is coordinated to minimize total travel time across all drivers. The total social cost is higher in user equilibrium ($SC(f_e)=200$) than in system optimum ($SC(f_e)=190$), illustrating how decentralized decisions can produce inefficient system-level outcomes.

\subsection{The Braess paradox}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.5\textwidth]{assets/braess_social_cost.pdf}
    \caption{Illustration of the Braess paradox in a simple four-node network. (a) Total social cost of the user equilibrium as a function of the free-flow travel time $\beta_{CB}$. (b) Network topology with 40 drivers traveling from origin $A$ (red) to destination $B$ (blue), along with the cost functions of all edges. The red cross indicates the case where edge $(C,B)$ is removed ($\beta_{CB} \rightarrow \infty$).}
    \label{fig:classicl-braess}
\end{figure}

The Braess paradox describes the counterintuitive phenomenon in which adding a link to a transportation network can increase overall congestion and travel times~\cite{braess1968paradoxon}. This paradox arises under user equilibrium because drivers minimizing their individual travel times can inadvertently create a globally suboptimal state. Similar to extensions of this concept to supply networks~\citep{schafer2022understanding, manik2022predicting}, we define the Braess paradox more broadly: a link is considered Braessian if adding capacity to it increases social cost in user equilibrium.
This naturally extends the classical definition, which corresponds to the case where the link initially has zero capacity.
For the following argument, consider the linear cost approximation in Eq.~\ref{eq:linear-travel-time}. Since $\beta_e$ represents free-flow travel time on edge $e$, we use it to identify Braessian behavior: if total social cost decreases as $\beta_e$ increases, then edge $e$ is Braessian.

\begin{definition}[Braessian edge]
An edge $e$ in a transportation network is called \emph{Braessian} if an increase in its capacity (or equivalently, a decrease in its free-flow travel time $\beta_e$) leads to an increase in the total social cost of the system. Formally, an edge $e$ is Braessian if
\begin{align}
    \frac{\partial SC(f_e)}{\partial \beta_e} < 0.
\end{align}
\end{definition}

In \Cref{fig:classicl-braess}, we illustrate the Braess paradox for a simple network topology (panel (b)) with the corresponding edge cost functions. In this example, 40 drivers travel from node $A$ (red) to node $B$ (blue). Panel (a) shows the total social cost in user equilibrium (see~\cref{eq:social-cost}) as a function of free-flow travel time $\beta_{CB}$. As expected, increasing $\beta_{CB}$ from zero to approximately one initially raises social cost. However, as $\beta_{CB}$ increases further (up to about 2.5), social cost declines and eventually stabilizes at a value lower than in the initial case of zero free-flow travel time. The red cross marks the social cost when edge $(C,B)$ is removed entirely, corresponding to $\beta_{CB} \rightarrow \infty$.\\

This behavior highlights the paradox. When edge $(C,B)$ is highly efficient (small $\beta_{CB}$), it attracts additional flow, so many drivers choose the apparently fastest route. The resulting overuse can increase congestion. Initially, increasing free-flow travel time on this edge raises overall travel time, as expected. Beyond a threshold, however, a paradoxical effect appears: as $\beta_{CB}$ grows further, drivers redistribute to alternative, less congested routes, reducing total social cost below the initial configuration. As the edge becomes less attractive, inefficient routing is mitigated and the system approaches a more efficient user equilibrium.

\subsection{The traffic assignment problem}
Having established the concepts of user equilibrium and system optimum, we now turn to the formal mathematical formulation of traffic assignment. The traffic assignment problem (TAP) seeks to determine how trips are distributed across a network for a given demand and network topology. This problem can be formulated in various ways, including link-based, path-based, and cycle-based representations~\cite{ahuja1995network}, which are equivalent under appropriate conditions (see Appendix~\ref{app:link-path-node} for details). Variational-inequality formulations provide an equivalent equilibrium characterization and theoretical basis for these models~\cite{dafermos1980traffic}.\\


In this work, we employ a node-link formulation of the TAP~\cite{nguyen1974algorithm}. To formally describe the network structure, we define the node-edge incidence matrix $E_{ne}$, which encodes the connectivity between nodes and edges:
\begin{align}\label{eq:edge-incidence}
    E_{ne} = 
    \begin{cases} 
    1, & \text{if edge } e \text{ originates at node } n, \\
    -1, & \text{if edge } e \text{ terminates at node } n, \\
    0, & \text{otherwise}.
    \end{cases}
\end{align}
The TAP is then stated as the optimization problem
\begin{align}\label{eq:tap-node-link}
    \min_{f_e} \quad & \sum_{e \in E} \mathcal{F}(f_e), \nonumber \\
    \text{subject to} \quad & \sum_{e \in E} E_{ne} f^w_e = p_n^w, \quad \forall n \in V,\ \forall w \in W, \nonumber \\
    & f^w_e \geq 0, \quad \forall e \in E,\ \forall w \in W, \nonumber \\
    & f_e = \sum_{w \in W} f_e^w, \quad \forall e \in E.
\end{align}
Here, $f_e^w$ denotes the flow on edge $e$ associated with the origin-destination (OD) tuple $w$, while $f_e$ represents the total flow on edge $e$, obtained by summing over all OD tuples.
For the analytical derivations below, each OD tuple is taken in the form $w=(o,d_1,d_2,\dots,d_n)$, i.e., one origin node $o$ supplying multiple destinations. This single-origin convention matches the computational setup and provides one gauge condition ($\lambda_o^w=0$) per tuple-specific support graph. The opposite convention (multiple origins, one destination) can be treated analogously by reversing edge directions.
The demand corresponding to an OD tuple $w$ is represented by the OD matrix whose components are defined as:
\begin{align}
    p^w_n &=\\
    &\begin{cases}
        y^o, & \text{if node } n \text{ is an origin in } w,\\[1mm]
        y^d, & \text{if node } n \text{ is a destination in } w,\\[1mm]
        0, & \text{otherwise}.
    \end{cases}
\end{align}
Here, $y^o>0$ denotes the total demand injected at an origin node, and $y^d<0$ the total demand withdrawn at a destination node. Additionally, the demand vector $\vec{p}^{\,w}$ is constructed to satisfy flow conservation: $\sum_{n \in V} p^w_n = 0.$

The objective function $\mathcal{F}(f_e)$ for the user equilibrium of the TAP is given by the cumulative travel cost experienced by all drivers on each edge, which is represented by the integration of the cost function~\cite{beckmann1956studies}
\begin{align}
    \mathcal{F}_{\text{ue}}(f_e) &= \int_0^{f_{e}} t_{e}^{(k)}(u)du.
\end{align}
In the linear approximation of the travel time function (see Eq.~\eqref{eq:linear-travel-time}), this becomes:
\begin{align}
\mathcal{F}_{\text{ue}}(f_e) = \frac{1}{2} \alpha_e f_e^2 + \beta_e f_e.
\end{align}
The system optimum, in contrast, is obtained by minimizing the total social cost across all edges (see Eq.~\ref{eq:social-cost}). Under the same linear approximation, the corresponding objective function is:
\begin{align}
\mathcal{F}_{\text{so}}(f_e) = f_e t_e(f_e) = \alpha_e f_e^2 + \beta_e f_e.
\end{align}
%\todo[inline]{add a sentence that this optimsation problem has to be solved to answer this or that question}
Solving the optimization problem in Eq.~\eqref{eq:tap-node-link} allows us to determine the equilibrium flow configuration that corresponds to either the user equilibrium or the system optimum, depending on the form of the objective function. This formulation therefore provides the analytical foundation for evaluating how changes in network structure or edge costs affect overall traffic patterns and system efficiency.

%\todo[inline]{maybe add a sentence, that in the linear approximation both optimization problems only differ by the factor $\frac{1}{2}$ in the quadratic term }
It is worth noting that, under the linear travel time approximation, the user-equilibrium and system-optimum formulations differ only by a factor of $\frac{1}{2}$ in the quadratic term of the objective function. Consequently, both problems share the same feasible region but yield distinct flow allocations due to the different weighting of congestion effects.


\section{Methods: Solving the optimization problems}\label{sec:methods-solve}
\subsection{Algebraic solution}\label{sec:tap-solution}
In this section, we derive an analytical solution for the user equilibrium of the TAP using the linear cost function specified in Equation~\ref{eq:linear-travel-time}.
To obtain a closed form, we first consider the equality-constrained system on a fixed active set (edges with positive flow). In practice, this active set is identified once from the full constrained problem, and the algebraic derivation below is then carried out on that fixed support.
For consistent terminology, we define
\begin{align}
\mathcal{A} &:= \{(w,e)\in W\times E:\ f_e^w>0\}
\quad\text{(stacked active set)},\\
E^w &:= \{e\in E:\ f_e^w>0\}
\quad\text{(active-edge set indexed by }w\text{)},\\
G^w &:= (V,E^w)
\quad\text{(active-support subgraph)}.
\end{align}
Thus, fixing the active set $\mathcal{A}$ is equivalent to fixing all active-support subgraphs $G^w$.
The corresponding Lagrangian function is formulated as follows:
\begin{align}\label{eq:lagrangian-deriv}
    \mathcal{L}(f_e^w, \lambda_n) &= \sum_{e \in E} \Bigl(\tfrac12\alpha_e f_e^{2}
    + \beta_e f_e\Bigr) \nonumber \\
    &\quad + \sum_{n \in V}\sum_{w \in W}\lambda_n^{w}
    \Bigl(p_n^{w} - \sum_{e \in E}E_{ne}f_e^{w}\Bigr),
\end{align}
where $\lambda_n^{w}$ denotes the Lagrange multiplier associated with node $n$ and OD‑tuple $w$.\\

To compute the optimal flows, we take the derivative of the Lagrangian with respect to $f_e^{w}$ and set it to zero:
\begin{align}\label{eq:deriv-lagrangian-zero}
\frac{\partial\mathcal{L}}{\partial f_e^{w}}
    = \alpha_e\Bigl(\sum_{w\in W}f_e^{w}\Bigr) + \beta_e
      - \sum_{n}\lambda_n^{w}E_{ne}
    \stackrel{!}{=}0,
\end{align}
where we have used the total‑flow condition $f_e=\sum_{w\in W}f_e^{w}$ from the optimisation problem Eq.~\ref{eq:tap-node-link}.\\

We can solve this equation to obtain the flows directly. However, because we have not yet enforced the non-negativity constraint $f_e^{w}\ge0$, the resulting flows may contain negative values, which are physically meaningless for vehicle flow.
For an edge $e=(n,m)$ in the active set of tuple $w$, Eq.~\ref{eq:deriv-lagrangian-zero} implies
\begin{align}
    f_e
    = \frac{1}{\alpha_e}\Bigl(\sum_{n\in V}\lambda_n^{w}E_{ne}-\beta_e\Bigr)
    = \frac{1}{\alpha_e}\bigl(\lambda_n^{w}-\lambda_m^{w}-\beta_e\bigr)
      \ge 0 .
\end{align}
From this we obtain the following necessary condition for active edges:
\begin{align}\label{eq:lambda-condition}
    \lambda_n^{w}\;\ge\;\lambda_m^{w}+\beta_e ,
\end{align}
which implies that, for each OD‑tuple $w$, the multiplier at any node $n$ must be at least as large as the multiplier at its neighbouring node $m$, plus the connecting edge length $\beta_e$.\\
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.5\textwidth]{assets/fig0-lambda-greater.pdf}
    \caption{Illustration of the directional-consistency condition imposed by~\cref{eq:lambda-condition}. Along each directed edge carrying positive flow, the multiplier at the tail node exceeds the multiplier at the head node by at least $\beta_e$. Consequently, the active support cannot contain directed loops when all edge lengths are strictly positive.}
    \label{fig:lambda-condition}
\end{figure}

The implications of this condition are illustrated in \cref{fig:lambda-condition}. For a directed edge $n\to m$ in the active set, \cref{eq:lambda-condition} gives $\lambda_n\ge\lambda_m+\beta_{nm}$. Summing this inequality along a directed cycle $C$ would yield
\begin{align}
    \lambda_n \ge \lambda_n + \sum_{e\in C}\beta_e,
\end{align}
which is impossible if all $\beta_e>0$. Hence, under this positivity assumption, each active-support subgraph is acyclic. This statement concerns the active-support subgraphs used in the algebraic solution, not necessarily the full physical network.

We can circumvent this limitation by decomposing the original graph into a set of active-support subgraphs. Consider an origin–destination tuple $w=(o,d_1,d_2,\dots,d_{|V|})$ and define the corresponding active-edge set by $E^w=\{e\in E: f_e^w>0\}$. Under \cref{eq:lambda-condition} with strictly positive $\beta_e$, the active-support subgraph $G^w(V,E^w)$ is acyclic.

\begin{figure*}[ht]
    \centering
    \includegraphics[width=\textwidth]{assets/multicom-fig.pdf}
    \caption{Decomposition of flows in an example graph under a positive‑flow constraint. \textbf{(a)} Total flow $f_e$, composed of the individual flow components $f_e^{w}$ shown in \textbf{(b)}–\textbf{(e)}. Each active-support subgraph $G^{w}(V,E^{w})$ also displays its respective OD‑matrix components $p_n^{w}$ colour‑coded on the nodes.}
    \label{fig:pos-flow-comp}
\end{figure*}

Repeating this construction for multiple origin–destination pairs, where each node serves as an origin exactly once, naturally leads to a decomposition of the overall flow into active-support subgraphs $G^{w}(V,E^{w})$. Each active-support subgraph shares the same node set $V$ but includes only edges with positive flow values (so that \cref{eq:lambda-condition} is satisfied), i.e. $E^{w}\subseteq E$. Consequently, each index $w$ defines one active-support subgraph, ensuring that all flow values remain non‑negative. The effective edge‑incidence matrix for each active-support subgraph can be expressed as
\begin{align}\label{eq:subgraph-edge-incidence}
    E^{w}_{ne}=
    \begin{cases}
        1  & \text{if edge }e\text{ originates at node }n\text{ and }f_e^{w}>0,\\
       -1  & \text{if edge }e\text{ terminates at node }n\text{ and }f_e^{w}>0,\\
        0  & \text{otherwise.}
    \end{cases}
\end{align}

By considering these active-support subgraphs we can reformulate the system using a generalized node‑edge incidence matrix, where columns corresponding to edges that do not exist in active-support subgraph $w$ are omitted:
\begin{align}\label{eq:generalized-incidence}
    \matr{\mathcal{E}}=
    \begin{bmatrix}
        \matr{E}^{1} & \matr{0} & \cdots & \matr{0}\\
        \matr{0} & \matr{E}^{2} & \cdots & \matr{0}\\
        \vdots   & \vdots   & \ddots & \vdots\\
        \matr{0} & \matr{0} & \cdots & \matr{E}^{W}
    \end{bmatrix}
    \in\mathbb{R}^{|V|\cdot|W|\times\bigl(|E^{1}|+|E^{2}|+\dots+|E^{W}|\bigr)}.
\end{align}
The total numbers of edges and nodes in all subflows are
\begin{align}
    N_{t,e} &= \sum_{w\in W}|E^{w}|\le |E|\cdot|W|,\\
    N_{t,n} &= \sum_{w\in W}|V^{w}| = |V|\cdot|W|.
\end{align}
For convenient notation we introduce the function $e(i)$, which returns the index of the edge in the original graph that corresponds to the edge in the active-support subgraph referred to by $i$ in the matrix $\matr{\mathcal{E}}$. 

This provides a structured way to represent the disaggregated flow components. If the active-support subgraph structure is known, the problem can be solved immediately using Eq.~\ref{eq:deriv-lagrangian-zero}. The active-support subgraph structure itself can be determined numerically by solving the problem once, after which the analytical formulation can be applied directly. This decomposition is particularly useful because it enables an analytical solution while preserving the non‑negativity of flows.
Thus, we can adjust the parameters $\alpha_e$ and $\beta_e$ of the system to generate similar solutions. The advantage of this approach is that it allows us to obtain multiple solutions while requiring a numerical solver only once.
The approach relies on the assumption that small variations in these parameters do not alter the active-support subgraph structure, ensuring the validity of the analytical solution.\\

In Fig.~\ref{fig:pos-flow-comp} we illustrate the traffic flow on a small graph under a positive‑flow constraint. Panel (a) depicts the total flow $f_e$, while panels (b)–(e) show the corresponding flow decompositions for each source $w$. To determine the individual active-support subgraph structures $G^{w}(V,E^{w})$, we first solve the full system numerically using the MOSEK or OSQP API for Python~\cite{mosek,stellato2020osqp} to obtain the respective Lagrange multipliers $\lambda_n^{w}$. In this example we consider four sources ($W=4$), leading to four active-support subgraphs, which are shown in panels (b)–(e). Combining these four active-support subgraphs reconstructs the total flow $f_e$ shown in panel (a).\\

%%%%%%%%%%%%%%%%%%%
\subsection{Matrix formulation of the TAP}

In order to prove in later sections that the social cost at user equilibrium is linear in the free‑flow travel time $\beta_e$, we first reformulate the optimality conditions of \cref{eq:deriv-lagrangian-zero} in matrix form. This allows us to express the TAP as a linear system of equations, which is convenient for subsequent analytical steps.

We start by incorporating the flow‑conservation constraint of the TAP,
\begin{align}
   \sum_{e\in E}E_{ne}f_e^{w}=p_n^{w},
\end{align}
and combine it with \cref{eq:deriv-lagrangian-zero} to obtain
\begin{align}
\matr{M}
\begin{pmatrix}
\vec{f}\\ \boldsymbol{\lambda}
\end{pmatrix}
=
\begin{pmatrix}
-\boldsymbol{\beta}\\ \vec{p}
\end{pmatrix}.
\end{align}
where the vector $\vec{f}$ collects the flow variables $f_e^{w}$ and the vector $\boldsymbol{\lambda}$ collects the Lagrange multipliers $\lambda_n^{w}$ for all nodes and OD‑tuples $w$.
The flow vector $\vec{f}$ is defined as
\begin{align}
\vec{f}=
\begin{pmatrix}
\vec{f}^{1}&\vec{f}^{2}&\dots&\vec{f}^{|W|}
\end{pmatrix}^{\!\top}
\in\mathbb{R}^{N_{t,e}}.
\end{align}
The entries of $\vec{f}$ are ordered by stacking the flows for each OD‑tuple $w$ consecutively; the first $|E^{1}|$ elements correspond to active-support subgraph $G^{1}(V,E^{1})$, the next $|E^{2}|$ to $G^{2}(V,E^{2})$, and so on (compare with~\cref{fig:pos-flow-comp}, panels (b)–(e)).

The vector of Lagrange multipliers $\boldsymbol{\lambda}$ is defined as
\begin{align}
\boldsymbol{\lambda}=
\begin{pmatrix}
\vec{\lambda}^{1}&\vec{\lambda}^{2}&\dots&\vec{\lambda}^{|W|}
\end{pmatrix}^{\!\top}
\in\mathbb{R}^{N_{t,n}},
\end{align}
where $\vec{\lambda}^{w}$ contains the multipliers for active-support subgraph $G^{w}(V,E^{w})$. The ordering follows the same stacking convention as for $\vec{f}$.

Analogously, we define the right‑hand‑side vectors: $\boldsymbol{\beta}\in\mathbb{R}^{N_{t,e}}$ contains the edge‑cost coefficients $\beta_i=\beta_{e(i)}$, and $\vec{p}\in\mathbb{R}^{N_{t,n}}$ contains the nodal demands $p_n^{w}$.

Finally, the coefficient matrix $\matr{M}$ has the block structure
\begin{align}
\matr{M}=
\begin{pmatrix}
\matr{K}&\matr{\mathcal{E}}^{\!\top}\\
\matr{\mathcal{E}}&\matr{0}
\end{pmatrix}
\in\mathbb{R}^{\bigl[N_{t,e}+N_{t,n}\bigr]\times\bigl[N_{t,e}+N_{t,n}\bigr]},
\end{align}
where $\matr{\mathcal{E}}$ is the stacked edge–node incidence matrix introduced in \cref{eq:generalized-incidence}. Furthermore, the matrix $\matr{K}\in\mathbb{R}^{N_{t,e}\times N_{t,e}}$ is defined as
\begin{align}
\matr{K}=
\begin{cases}
\alpha_{e(j)} & \text{if }e(l)=e(j),\\[2pt]
0             & \text{otherwise.}
\end{cases}
\end{align}
and $\matr{0}$ denotes the zero matrix.\\

For many configurations this problem is underdetermined, because only the total flows on the edges matter, which allows for multiple configurations of how the subflows create these optimal total flows. Furthermore, the solutions depend only on differences in $\lambda$ values, so one reference $\lambda$ must be fixed for each active-support subgraph. Finally, the condition that every active-support subgraph must have the same inflow and outflow is also fixed by the structure of the equations. In order to obtain an invertible problem, each of these issues must be addressed.

To fix how the subflows combine into the total flows, the most straightforward way is to minimise the square of the individual flows; this favours an even share between different flows on the individual edges. This is done by adding a small value $\delta$ to the diagonal of $\matr{K}$. This $\delta$ should be much smaller than all $\alpha$, so it only resolves the problem of multiple solutions without changing the total flows.

The $\lambda$ value of the single source for each origin‑destination tuple is set to zero, and the continuity equation for that same node is removed in each active-support subgraph because it is redundant.

This gives the resulting matrix,
\begin{align}
\tilde{\matr{M}} &=
\begin{pmatrix}
\tilde{\matr{K}} & \tilde{\matr{\mathcal{E}}}^{\!\top}\\
\tilde{\matr{\mathcal{E}}} & \matr{0}
\end{pmatrix}
    \in\mathbb{R}^{\bigl[N_{t,e}+N_{t,n}-|W|\bigr]\times\bigl[N_{t,e}+N_{t,n}-|W|\bigr]},\\
\tilde{\matr{K}} &= \matr{K}+\delta\mathbb{1}.
\end{align}
This matrix is invertible and the solutions for the flows and $\lambda$’s can therefore be written as
\begin{align}\label{eq:flow-solution-mat}
\begin{pmatrix}
\vec{f}\\ \tilde{\boldsymbol{\lambda}}
\end{pmatrix}
= \tilde{\matr{M}}^{-1}
\begin{pmatrix}
-\boldsymbol{\beta}\\ \tilde{\vec{p}}
\end{pmatrix}.
\end{align}

To simplify the notation, the tildes are omitted from here on. 
Using the Schur complement,
\begin{align}\label{eq:schur-complement}
\matr{S}= -\matr{\mathcal{E}}\matr{K}^{-1}\matr{\mathcal{E}}^{\!\top},
\end{align}
which corresponds to the negative of the Laplacian for the system of active-support subgraphs. Then we can write
\begin{align}\label{eq:M-mat}
\matr{M}^{-1}=
\begin{pmatrix}
\matr{K}^{-1}+\matr{K}^{-1}\matr{\mathcal{E}}^{\!\top}\matr{S}^{-1}\matr{\mathcal{E}}\matr{K}^{-1}
    & -\matr{K}^{-1}\matr{\mathcal{E}}^{\!\top}\matr{S}^{-1}\\[4pt]
-\matr{S}^{-1}\matr{\mathcal{E}}\matr{K}^{-1}
    & \matr{S}^{-1}
\end{pmatrix}.
\end{align}
Using this matrix formulation we provide a compact algebraic representation of the TAP solution, which will be particularly useful for deriving analytical properties of the equilibrium solution in subsequent sections.
%%%%%%%%%%%%%%%%%%%%%%5

\subsection{Linearity of social cost}
\begin{lemma}[Linearity of Social Cost in User Equilibrium]\label{lemma:linear}
For a fixed active-support subgraph in the traffic assignment problem, the social cost at user equilibrium is linear in the free‑flow travel times $\beta_e$; across active-support subgraph changes, it is piecewise linear.
\end{lemma}

\begin{proof}
First we note that the total social cost is given by
\begin{align}
    SC &= \sum_{e} f_e t_e\\
       &= \sum_{e} f_e\bigl(\alpha_e f_e+\beta_e\bigr)\\
       &= \sum_{w}\sum_{e} f_e^{w}\bigl(\alpha_e f_e+\beta_e\bigr).
\end{align}
From \cref{eq:deriv-lagrangian-zero} we know that this is equal to
\begin{equation}
    SC = \sum_{w}\sum_{e} f_e^{w}\bigl(\lambda^w_{o(e)}-\lambda^w_{d(e)}\bigr).
\end{equation}
where $\lambda^w_{o(e)}$ and $\lambda^w_{d(e)}$ denote the OD-specific multipliers at the origin and destination nodes of edge $e$.
By noting that the vector $\vec{p}$ contains the flow starting at the unique origin node of active-support subgraph $w$, $o(w)$, and ending at node $n$, and that the total travel time is independent of the path taken, we have
\begin{equation}
\begin{split}
t^{w}_{\text{total},n}
    &= \sum_{e\in\text{path}(o(w),n)} t_e\\
    &= \sum_{e\in\text{path}(o(w),n)}\bigl(\lambda^{w}_{o(e)}-\lambda^{w}_{d(e)}\bigr)\\
    &= \lambda^{w}_{o(w)}-\lambda^{w}_{n}.
\end{split}
\end{equation}
Therefore
\begin{equation}
    SC = -\sum_{w}\sum_{n} p^{w}_{n}\,t^{w}_{\text{total},n}
        = -\sum_{w}\sum_{n}p^{w}_{n}\bigl(\lambda^{w}_{o(w)}-\lambda^{w}_{n}\bigr).
\end{equation}
Here $\vec{p}$ is the reduced stacked vector that contains destination-withdrawal magnitudes only. Using the stacked notation from before and the fact that we set $\lambda^{w}_{o(w)}=0$, we obtain
\begin{equation}
    SC = -\sum_{i} p_{i}\lambda_{i}.
\end{equation}
With \cref{eq:flow-solution-mat} this can be rewritten as
\begin{equation}
    SC = -\sum_{i} p_{i}\bigl(\matr{S}^{-1}\matr{\mathcal{E}}\matr{K}^{-1}\boldsymbol{\beta}
                     + \matr{S}^{-1}\vec{p}\bigr)_{i}.
\end{equation}
Hence $SC$ is linear in every $\beta_{k}$. The derivative of $SC$ with respect to $\beta_{k}$ is
\begin{equation}\label{eq:cost-gradient}
    \frac{\partial SC}{\partial \beta_{k}}
        = -\,p_{q}\,\matr{S}^{-1}_{qp}\,\matr{\mathcal{E}}_{pl}\,\matr{K}^{-1}_{lj}\,\delta_{e(j),k},
\end{equation}
where summation over repeated indices is implied.
The analytical expression for $\matr{K}^{-1}_{lj}$ is
\begin{align}
\matr{K}^{-1}_{lj}= \frac{1}{\delta}
\begin{cases}
1-\dfrac{\alpha_{e(j)}}{\delta+\alpha_{e(j)}\,n(e(j))}, & l=j,\\[6pt]
-\dfrac{\alpha_{e(j)}}{\delta+\alpha_{e(j)}\,n(e(j))}, & e(l)=e(j)\ \text{and}\ l\neq j,\\[6pt]
0, & \text{otherwise.}
\end{cases}
\end{align}
where $n(e(i))$ is the number of subflows that include edge $e(i)$. Defining $\matr{L}_{lj}= \delta \matr{K}^{-1}_{lj}$, \cref{eq:cost-gradient} becomes
\begin{equation}
    \frac{\partial SC}{\partial \beta_{k}}
        = p_{q}\bigl(\matr{\mathcal{E}}\matr{L}\matr{\mathcal{E}}^{\!\top}\bigr)^{-1}_{qp}\,
          \matr{\mathcal{E}}_{pl}\,\matr{L}_{lj}\,\delta_{e(j),k}.
\end{equation}
For a fixed active-support subgraph, this expression is independent of $\beta_k$ (indeed of $\boldsymbol{\beta}$), so the derivative is constant in that regime.
Writing it this way removes the prefactor $1/\delta$, which makes the step‑wise calculation on a computer more accurate, even for very small $\delta$.
\end{proof}


% OLD VERSION
% To show that the social cost depends linearly on $\beta_e$, we take its derivative with respect to $\beta_e$.

% Substituting the linear cost function~\cref{eq:linear-travel-time} into the definition of the social cost~\cref{eq:social-cost} yields the following expression for the social cost:
% \begin{equation}
%     sc = \sum_{e} \left( \alpha_e f_e^2 + \beta_e f_e \right).
% \end{equation}
% Using \cref{eq:deriv-lagrangian-zero}, the equilibrium flow can be expressed as:
% \begin{equation}
%     f_e = \sum_w f_e^w = \frac{1}{\alpha_e} 
%     \left( \sum_n \lambda^w_n E^w_{ne} - \beta_e \right),
% \end{equation}
% where $e$ is the index of an edge in subgraph $w$.\\

% Substituting this into the expression for social cost (see~\cref{eq:social-cost}) yields the social cost at user equilibrium:
% \begin{align}
%     \begin{split}
%         sc &= \sum_{e} \frac{1}{\alpha_e} \Biggl( \left(
%         \sum_n \lambda^w_n E^w_{ne} - \beta_e \right)^2 \\
%         &+ \beta_e \left( \sum_n \lambda^w_n E^w_{ne} - \beta_e \right) \Biggl) \\
%         &= \sum_{e} \frac{1}{\alpha_e} \left(
%         \left( \sum_n \lambda^w_n E^w_{ne} \right)^2 
%         -  \beta_e \left( \sum_n \lambda^w_n E^w_{ne} \right)
%         \right).
%     \end{split}
% \end{align}
% Here, the index $w = w(e)$ depends on $e$ because for every edge $e$, we must pick a corresponding subgraph $G(V, E^w)$ that contains the edge $e$. 

% Now, we change the index notation and replace $w$ and $e$ with a unified index $i$, following the same approach used in the matrix notation. All relevant quantities are stacked into vectors. Using this notation, we can rewrite the social cost as:
% \begin{equation}
%     sc = \sum_{i} \frac{1}{n_i \alpha_i} \left(
%         \left( \sum_j \lambda_j \mathcal{E}_{ji} \right)^2 
%         -  \beta_i \left( \sum_j \lambda_j \mathcal{E}_{ji} \right)
%         \right)
% \end{equation}
% where $\alpha_i$, $\beta_i$, and $\lambda_i$ are the stacked versions of $\alpha_e$, $\beta_e$, and $\lambda_n$, respectively. Similarly, $\mathcal{E}_{ji}$ represents the stacked incidence matrices, and for a system with $W$ subgraphs, this stacked incidence matrix takes the same block diagonal form as in \cref{eq:generalized-incidence}.
% To avoid double counting edges that appear in multiple subgraphs, we normalize by the number of subgraphs $n_i$ in which each edge $i$ appears.\\


% Then, the derivative with respect to $\beta_k$ can be calculated as:
% \begin{align}\label{eq:derivative_sc}
%     \begin{split}
%         \frac{\partial sc}{\partial \beta_k} &= 
%         \sum_{i} \frac{1}{n_i \alpha_i} \left(
%         2 \left( \sum_j \lambda_j \mathcal{E}_{ji} \right) 
%         \left( \sum_l \frac{\partial \lambda_l}{\partial \beta_k} \mathcal{E}_{li} \right) \right. \\
%         &+ \left.  \beta_i \left( \sum_j \frac{\partial \lambda_j}{\partial \beta_k} \mathcal{E}_{ji}  \right) \right)
%         + \frac{1}{\alpha_k n_k} \left( \sum_j \lambda_j \mathcal{E}_{jk} \right)
%         \end{split}
% \end{align}
% From \cref{eq:flow-solution-mat} we can compute the stacked Lagrange multipliers as:
% \begin{equation}
%     \lambda_j = \sum_i -C_{ji} \beta_i + \sum_l D_{jl} p_l
%     \label{eq:lambda}
% \end{equation}
% Where $\matr{C}$ and $\matr{D}$ are the two bottom blocks of the inverse matrix $\matr{M}^{+}$ from \cref{eq:M-mat}, 
% \begin{align}
%     \begin{split}
%     \matr{C} &= (\matr{\mathcal{E}} \matr{K}^{+} \matr{\mathcal{E}}^\top)^{+} \matr{\mathcal{E}} \matr{K}^{+} \\
%     \matr{D} &= (\matr{\mathcal{E}} \matr{K}^{+} \matr{\mathcal{E}}^\top)^{+}.
%     \end{split}
% \end{align}
% Then, the derivative of the Lagrange multipliers with respect to $\beta_k$ is given by:
% \begin{equation}
%     \frac{\partial \lambda_i}{\partial \beta_k} = -C_{ik}
%     \label{eq:derivative_lambda}
% \end{equation}
% Furthermore, the factor $\frac{1}{n_i \alpha_i}$ can be rewritten as the sum over a matrix with:
% \begin{equation}
%     \frac{1}{n_i \alpha_i} = \sum_j \begin{cases}
%         \frac{1}{\alpha_i n_i} & \text{if } i = j \\
%         0 & \text{else}
%     \end{cases}
% \end{equation}\todo{sollten die indizes in der summe dann nicht $j$ sein?}
% This diagonal matrix can be identified as a pseudo--inverse of the matrix $\matr{K}$,
% \begin{equation}
%     K^{+}_{ij} = \begin{cases}
%         \frac{1}{\alpha_i n_i} & \text{if } i = j \\
%         0 & \text{else}
%     \end{cases}
%     \label{eq:K_inv}
% \end{equation}
% Substitute \cref{eq:lambda,eq:derivative_lambda,eq:K_inv} into \cref{eq:derivative_sc} and use Einstein notation to get:
% \begin{equation}
%     \begin{split}
%     \frac{\partial sc}{\partial \beta_k} &= 2 K^{+}_{iq} (-C_{js} \beta_s + D_{jl} p_l) \mathcal{E}_{ji} (-C_{rk} \mathcal{E}_{rq}) \\
%         &+  K^{+}_{iq} \beta_q (- C_{jk} \mathcal{E}_{ji}) + K^{+}_{kq} (-C_{js} \beta_s + D_{jl} p_l) \mathcal{E}_{jq}
%     \end{split}
% \end{equation}
% Using the fact that $(K^{+})^\top = K^{+}$ this can be reordered and rewritten to:
% \begin{equation}
%     \begin{split}
%     \frac{\partial sc}{\partial \beta_k} &= 2  C_{kr}^\top \mathcal{E}_{rq} K^{+}_{qi} \mathcal{E}_{ij}^\top (C_{js} \beta_s - D_{jl} p_l)\\
%         &- C_{kj}^\top \mathcal{E}_{ji}  K^{+}_{iq} \beta_q - K^{+}_{kq} \mathcal{E}_{qj}^\top (C_{js} \beta_s - D_{jl} p_l) 
%     \end{split}
% \end{equation}
% Switching to matrix--vector notation this yields:
% \begin{equation}
%     \begin{split}
%     \frac{\partial sc}{\partial \beta_k} &= \left(2  \matr{C}^\top \matr{\mathcal{E}} \matr{K}^{+} \matr{\mathcal{E}}^\top (\matr{C} \vec{\beta} - \matr{D} \vec{p}) \right.\\
%         & \left. - \matr{C}^\top \matr{\mathcal{E}}  \matr{K}^{+} \vec{\beta} - \matr{K}^{+} \matr{\mathcal{E}}^\top (\matr{C} \vec{\beta} - \matr{D} \vec{p}) \right)_k
%     \end{split}
%     \label{eq:derivative_sc_mat}
% \end{equation}
% Next we compute the transposed of the matrices $\matr{C}$ and $\matr{D}$:
% \begin{equation}
%     \begin{split}
%         \matr{C}^\top &= \matr{K}^{+} \matr{\mathcal{E}}^\top (\matr{\mathcal{E}} \matr{K}^{+} \matr{\mathcal{E}}^\top)^{+} \\
%         \matr{D}^\top &= (\matr{\mathcal{E}} \matr{K}^{+} \matr{\mathcal{E}}^\top)^{+}
%     \end{split}
%     \label{eq:schur}
% \end{equation}
% \todo[inline]{erkläre warum transpose so richtig sind. Symmetrie von $K$ -> $K^{+}$ -> $(E K^{+} E^\top)^{+}$ }
% Inserting \cref{eq:schur} into \cref{eq:derivative_sc_mat} and simplifying gives:
% \begin{equation}\label{eq:cost-gradient}
%     \begin{split}
%         \frac{\partial sc}{\partial \beta_k} &= - (\matr{C}^\top \vec{p})_k \\
%         &= -\frac{1}{n_k \alpha_k}\sum_{j,l} \mathcal{E}_{jk} D_{jl} p_l = \frac{1}{n_k \alpha_k} \sum_{l} (D_{k[0] l} - D_{k[1] l} )p_l
%     \end{split}
% \end{equation}
% which is independent of $\beta_e$ and proving that the social cost is linear in free-flow travel time.
% \end{proof}


In this proof, we used the algebraic solution of user-equilibrium flows (given by \cref{eq:flow-solution-mat} for the optimization problem in \cref{eq:tap-node-link}) to compute the derivative of social cost with respect to an edge's free-flow travel time $\beta_e$. We showed that this derivative is constant with respect to $\beta_e$. This property allows us to determine whether social cost increases or decreases as $\beta_e$ changes, thereby assessing whether individual edges contribute to system efficiency or inefficiency.\\

However, there are important caveats. First, we must solve the system numerically once to identify active-support subgraphs $G^w(V,E^w)$ where algebraic solutions exist. Second, linearity of social cost can only be established within a fixed active-support subgraph. If $\beta_e$ changes substantially, the active-support subgraph may change, and the algebraic solution may no longer apply. Consequently, this approach characterizes the system under infinitesimal changes in $\beta_e$; equivalently, it establishes piecewise linearity (see Appendix~\ref{app:active-set-stability} for a quantitative stability scan and Appendix~\ref{app:local-breakpoint-predictor} for the local first-breakpoint predictor).


\subsection{Social cost gradient centrality}\label{sec:scgc}

We refer to the newly introduced measure defined in \cref{eq:cost-gradient} as \textit{social cost gradient centrality} (SCGC). It quantifies the sensitivity of the total social cost to incremental variations in the free-flow travel time parameter $\beta_e$. By explicitly capturing how marginal adjustments to edge characteristics influence network-wide performance, SCGC ranks edges according to their functional significance in maintaining, improving, or impairing the system’s efficiency.\\

Edges with high SCGC values are critical for overall network performance, as increases in their free-flow travel time would lead to substantial rises in total social cost. Such edges form the structural backbone of the network and require careful operational management. In contrast, edges with low SCGC values have little influence on aggregate efficiency, making them flexible candidates for reallocation, traffic calming, or other interventions. Finally, edges with negative SCGC values correspond to \textit{Braess edges}: decreasing their free-flow travel time would paradoxically increase total system cost. This offers a direct and quantitative criterion for detecting Braess-like behavior in large-scale networks without relying on stylized examples or exhaustive scenario testing.\\

Classical formulations of the Braess paradox \cite{braess1968paradoxon} identify paradoxical behavior through specific network topologies or through numerical experiments that remove edges and recompute equilibria. SCGC generalizes this concept: rather than requiring $|E|+1$ equilibrium computations, we obtain the gradient information analytically after solving the traffic assignment problem once. This makes the method computationally tractable even for large real-world networks.\\

Leveraging \cref{lemma:linear}, the SCGC can be computed efficiently, as it only requires the pseudo-inverse of the Schur complement of the KKT system associated with the linearized problem. The measure provides immediate insight into whether small increases in edge cost parameters improve or worsen system efficiency. It is important to note that the method assumes the active-support subgraph $G^w(V,E^w)$ remains unchanged under small variations in $\beta_e$. While valid for marginal perturbations, this assumption may not hold for larger interventions such as complete edge removal. Therefore, SCGC provides a reliable local indicator for identifying Braess edges and other critical links, while larger structural changes may require additional equilibrium computations.


%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%





%\newpage
\section{Results: Applications to real world road networks}\label{sec:results}
In the following, we apply the SCGC framework to both synthetic and real-world urban road networks to demonstrate its computational efficiency and interpretive value.
\subsection{Validating social cost gradient centrality}
\begin{figure*}[ht] 
\centering \includegraphics[width=\textwidth]{assets/classic-braess-social-cost.pdf} \caption{Derivative of the social cost with respect to $\beta_e$ for each edge in a small example graph. \textbf{(a)} Analytical solution compared to \textbf{(b-f)} numerical approximations. Positive values (red) indicate that increasing $\beta_e$ raises the social cost, while negative values (blue) suggest a decrease, marking the edge as Braessian.} \label{fig:braess-social-cost} 
\end{figure*}

To validate our approach, \cref{fig:braess-social-cost} illustrates the derivative of social cost with respect to $\beta_e$ for each edge in a small example graph. Panel (a) shows the analytical solution (see \cref{eq:cost-gradient}). Panels (b–f) display numerical evaluations obtained through multiple numerical solutions, specifically, solving the system 25 times per edge, amounting to 125 solutions in total for this small example. The analytical method thus significantly reduces computational effort.

Edges highlighted in red exhibit positive derivatives, indicating that increasing their costs leads to higher social costs. In contrast, edges highlighted in blue show negative derivatives, implying that raising their costs reduces total social cost, thereby classifying them as Braessian.

Panels (b--f) further show that analytical and numerical solutions coincide in a neighborhood of the initial $\beta_e$ values (highlighted in matching colors), where the relationship between social cost and $\beta_e$ is piecewise linear. As $\beta_e$ deviates further from its baseline, discrepancies emerge due to structural changes in the active-support subgraph, underscoring that the analytical approximation is most reliable for small perturbations of $\beta_e$ (see Appendices~\ref{app:active-set-stability} and~\ref{app:local-breakpoint-predictor}).

Additionally, in panels (b–e) we demonstrate that the SCGC is positive, meaning that increasing the corresponding $\beta_e$ values results in higher overall social cost. In contrast, panel (f) presents an edge with a negative SCGC, indicating that an increase in $\beta_e$ for this edge would reduce social cost, revealing a Braessian effect.











\subsection{Ranking edges by social cost gradient centrality}
\begin{figure*}[ht]
\centering
\includegraphics[width=\textwidth]{assets/synthetic-gamma-scan.pdf}
\caption{Visualization of \textbf{(a)} traffic flows and \textbf{(b)} SCGC on a synthetic planar graph $G(V,E)$ with $|V| = 50$ nodes and $|E| = 270$ edges. \textbf{(c)} Scatter plot comparing traffic flows and SCGC values.}
\label{fig:cost-gradient}
\end{figure*}
The SCGC quantifies the sensitivity of the total social cost with respect to changes in an edge’s free-flow travel time $\beta_e$ (e.g., due to speed limit adjustments). High SCGC values indicate edges where small increases in travel time result in disproportionately large increases in total social cost, highlighting their systemic importance.

To illustrate this concept, \cref{fig:cost-gradient} presents traffic flows and SCGC values for a synthetic planar graph $G(V,E)$ with $|V| = 50$ nodes and $|E| = 270$ edges, representing a stylized urban road network. The cost function parameter $\alpha_e$ (see \cref{eq:linear-travel-time}) was sampled uniformly from the interval $[0.1, 1]$. The free-flow travel time parameter $\beta_e$ was determined from the geodesic length of each edge, assuming a uniform speed limit of $50,\mathrm{km/h}$.

Next, we assigned node populations according to a power-law distribution with an exponent of $-1$, resulting in a few highly populated nodes and many nodes with relatively small populations, reflecting typical real-world urban network structures. Based on these populations, we constructed an origin–destination (OD) matrix in which a fraction of each node’s population travels to other nodes.

In this formulation, we assume that the likelihood of drivers originating from or traveling to a node is determined solely by its population. As a result, the probability of traveling between any two nodes is independent of the distance separating them. While this assumption simplifies the model, a more realistic representation could incorporate distance effects, for example by using a gravity model~\cite{wassmer2024resilience}. We therefore interpret the synthetic benchmark as a controlled stress test of the method rather than as a calibrated demand model.


Panel (a) of \cref{fig:cost-gradient} shows the resulting traffic flows, while panel (b) presents the corresponding SCGC values for each edge. Centrally located edges tend to exhibit both higher traffic flows and larger SCGC values. This is because more shortest paths pass through these edges, making them critical for network-wide accessibility. Consequently, even small perturbations to their free-flow travel times $\beta_e$ can strongly affect total social cost.

Interestingly, five edges display negative SCGC values, indicating that increasing their free-flow travel times $\beta_e$ would \emph{decrease} the total social cost and thus identifying them as Braessian edges.

Panel (c) presents a scatter plot comparing traffic flows with SCGC values. While a positive correlation is evident, the relationship is not strictly linear or one-to-one. This demonstrates that SCGC captures additional structural information beyond simple traffic volumes, offering a more nuanced perspective on network vulnerability and intervention points.






%In \cref{fig:osm-flow}, we illustrate the convergence of user equilibrium flows under varying numbers of source nodes. Panel (a) compares six real-world road networks from German city districts, Nippes, Cologne (blue), Pankow, Berlin (orange), Potsdam (green), Heidelberg (red), Koblenz (purple), and Göttingen (brown), all of similar size. To quantify convergence, we compute the difference in user equilibrium flows between a given number of source nodes, $|W|$, and the full solution with $|V|$ source nodes, then determine the standard deviation over all edges. Notably, this deviation increases rapidly across all graphs, indicating that using all nodes as source nodes may be unnecessary. To balance computational efficiency with accuracy, we find that selecting 10\% of nodes as source nodes provides a reasonable trade-off.\\

%Furthermore, to illustrate how source nodes are selected, panels (b–d) depict the user equilibrium flow on the road network of Nippes, Cologne, color-coded according to flow intensity. Panels (b) and (c) show results for 3 and 15 source nodes, respectively, with selected source nodes marked by red crosses. In panel (d), where all nodes act as source nodes, we omit the markers for clarity.



\subsection{Event-driven traffic in Cologne}\label{sec:football-cologne}
\begin{figure*}[ht]
    \centering
    \includegraphics[width=\textwidth]{assets/cologne-stadium-traffic.pdf}
    \caption{Visualization of vehicle flows and derivative social costs (SCGC) during a football event in Cologne, Germany. 
    Color coding in \textbf{(a)} shows vehicle flows $f_e$ across the road network. 
    Color coding in \textbf{(b)} depicts the derivative of the social cost with respect to $\beta_e$, highlighting Braess edges in blue.}
    \label{fig:football-cologne}
\end{figure*}
To illustrate the practical relevance of our framework, we analyze the traffic impact of a major football event in Cologne, Germany. 
We construct the city’s street network from OpenStreetMap (OSM) following the procedure in \cref{sec:generate_graphs}, resulting in a directed graph $G = (V, E)$ with $|V| = 835$ nodes and $|E| = 2{,}438$ edges. 
Each road segment is assigned a linear cost function as described in \cref{sec:osm-cost-func}, and travel demand is generated from population data according to \cref{sec:od-matrix}. 
This yields a realistic yet computationally tractable representation of the city’s road infrastructure and demand during large-scale events.


The primary source of traffic demand is the set of parking lots surrounding the football stadium. 
In the baseline calibration, this corresponds to $n_\mathrm{vehicles}=15{,}000$ event-related trips. 
The parking locations are geocoded, and the nearest nodes in the network are defined as destination nodes $W$. 
We then solve the traffic assignment problem as described in~\cref{sec:tap-solution}, yielding user equilibrium flows $f_e$ on each edge. 
As shown in Figure~\ref{fig:football-cologne}\textbf{a}, the resulting flow pattern exhibits strong spatial concentration along the city’s main arterial roads leading to the stadium, which form the backbone of the event-related traffic system.\\

To assess the network’s vulnerability to inefficiencies, we compute the derivative of the social cost with respect to $\beta_e$, $\partial SC/\partial \beta_e$ (SCGC), for each edge as outlined in \cref{sec:scgc}. 
Edges with negative SCGC values indicate Braess edges, links where a decrease in capacity, for example by lowering speed limits (i.e., increasing free-flow travel time), could paradoxically reduce overall travel costs. 
Figure~\ref{fig:football-cologne}\textbf{b} highlights these edges in blue, revealing structurally important corridors and potentially counterproductive links whose management can substantially influence system performance.\\

Across the entire network of 2,438 edges (with a total length of 2,105\,km), we identify 32 Braess edges in the baseline event scenario (about 1.31\% of all links), with a combined length of 24.1\,km (1.14\% of total network length). 
The minimum SCGC value is $\min(\partial SC/\partial \beta_e) \approx -70.1$, while the largest positive value reaches $\max(\partial SC/\partial \beta_e) \approx 2{,}846.7$, concentrated along a few high-capacity arterial corridors. 
The median SCGC is relatively low (2.66), reflecting that only a limited number of edges exert a dominant influence on network efficiency.\\

To test robustness, we scale the same OD matrix by factors $0.8$, $1.0$, and $1.2$. 
The number of Braess edges increases from 18 (0.74\%) at $0.8\times$ demand to 32 (1.31\%) at baseline and 66 (2.71\%) at $1.2\times$ demand; the corresponding Braess-edge length rises from 14.2\,km to 24.1\,km and 60.4\,km. 
Hence, paradoxical corridors become more prevalent as event demand intensifies.\\

We additionally perform a quantitative stress test of edge-ranking methods (SCGC vs flow vs betweenness vs random) by applying $+1\%$ perturbations to selected free-flow times and recomputing equilibrium social cost. 
The chosen perturbation magnitude is deliberately local: it lies below the median active-set stability radius of about $3.5\%$ reported in Appendix~\ref{app:active-set-stability}, so first-order rankings are evaluated primarily within the locally stable regime.
Intuitively, this asks a simple question: if we slightly ``stress'' the roads that each ranking declares most important, which ranking causes the largest system-wide damage under the same intervention budget? 
In this sense, a better ranking should produce a larger realized increase in social cost because it identifies truly critical links.
SCGC-linear ranking dominates all comparators across budgets $k=1,\dots,8$ for all three demand levels (win share 100\%). 
At baseline demand, the mean realized increase in social cost across budgets is 0.01485\% for SCGC, versus 0.01098\% (flow), 0.00882\% (betweenness), and 0.00488\% (random). 
For single-edge perturbations, the rank correlation between predicted and observed damage is $\rho\approx0.9997$ for SCGC, compared with $\rho\approx0.5457$ for flow and $\rho\approx0.1029$ for betweenness. 
This confirms that SCGC is not only interpretable but also predictive for local intervention impact in this real-world case (see Appendix~\ref{app:intervention-validation}).\\

Major arterial roads exhibit the highest positive SCGC values, reflecting their structural role in maintaining efficient access to the stadium. 
These roads are critical for event-related traffic and should remain as free of disturbances as possible. 
Measures such as restricting through traffic, imposing parking bans, or providing dedicated lanes could help safeguard their capacity and ensure smooth flows. 

In contrast, the identified Braess edges are primarily located on secondary or connector roads. 
Although they carry less flow, they have a disproportionately negative effect on network-wide performance. 
Reducing their attractiveness, e.g., through temporary speed limit reductions, dynamic access restrictions, or partial closures, can encourage more efficient routing and alleviate congestion elsewhere. 
Because these links are not central access routes to the stadium, such interventions can be implemented with minimal disruption to event traffic.\\

A promising traffic management strategy would be to prioritize access to high-SCGC (red) corridors for event traffic while diverting background traffic to lower-SCGC (blue or neutral) roads. 
This separation of flow classes can help prevent capacity bottlenecks and stabilize travel times. 
More generally, sensitivity-based indicators such as SCGC provide a systematic basis for identifying and managing structurally important or counterproductive links in urban road networks, enabling targeted, adaptive, and event-specific traffic control strategies.

Overall, this case study demonstrates how real-world data, traffic assignment modeling, and sensitivity analysis can be combined to produce actionable insights for urban mobility management. 
Rather than expanding capacity uniformly, targeted interventions on a small number of critical and Braess edges offer a cost-effective means of improving network performance during major events.



\subsection{Daily urban traffic analysis in Potsdam}\label{sec:potsdam}
\begin{figure*}[ht]
    \centering
    \includegraphics[width=\textwidth]{assets/Potsdam, Germany-braess.pdf}
    \caption{Visualization of vehicle flows and derivative social costs (SCGC) in Potsdam, Germany. 
    Color coding in \textbf{(a)} shows the edge utilization $1 - \beta_e / (\alpha_e f_e + \beta_e)$ across the road network, 
    while color coding in \textbf{(b)} depicts the derivative of the social cost with respect to $\beta_e$, highlighting Braess edges in blue.}
    \label{fig:potsdam}
\end{figure*}

To demonstrate the applicability of our framework to everyday mobility patterns, we analyze the daily traffic structure of Potsdam, Germany. 
The city’s street network is constructed from OpenStreetMap using the methodology described in \cref{sec:generate_graphs}, 
resulting in a directed graph $G = (V, E)$ with $|V| = 112$ nodes and $|E| = 296$ edges. 
Each edge is assigned a linear cost function following \cref{sec:osm-cost-func}, and travel demand is generated from population data as outlined in \cref{sec:od-matrix}. 
We choose the OD matrix such that the resulting flows represent a moderate traffic scenario, which is representative of typical conditions in many medium-sized European cities. 
In contrast to the Cologne scenario, where demand is concentrated near a stadium, here it is distributed evenly across the network to reflect typical daily mobility.\\

We begin by analyzing edge utilization, defined as
\begin{align*}
    u_e = 1 - \frac{\beta_e}{\alpha_e f_e + \beta_e}.
\end{align*}
This measure reflects the share of available capacity that is effectively used on a given edge: values close to one indicate heavily used links operating near capacity, while values close to zero correspond to underutilized links with little traffic relative to their capacity.  
Figure~\ref{fig:potsdam}a visualizes the resulting utilization pattern across the network. 
The average utilization is $0.46$, with a median of $0.46$ and a maximum of $0.94$, indicating a clear differentiation between heavily used corridors and underutilized links. 
We identify 26 edges (8.8\% of the network) with utilization above $0.8$, corresponding to a total length of 16.4\,km. 
These high-utilization corridors likely coincide with the city’s primary arterials, concentrating most of the daily traffic flow and playing a crucial role in maintaining network accessibility and efficiency.\\

At the same time, 48 edges (16.2\% of the network), covering 79.4\,km of roadway, exhibit utilization values below $0.2$. 
This underutilization highlights a large share of the network where capacity remains unused. 
However, low utilization alone does not necessarily imply low importance for overall network performance, since some low-flow links may still be structurally relevant. 
To determine their actual impact on efficiency, we turn to the SCGC analysis.\\

We next examine the derivative of the social cost with respect to $\beta_e$, $\partial SC/\partial \beta_e$ (SCGC), as described in \cref{sec:scgc}. 
Figure~\ref{fig:potsdam}b shows the spatial distribution of SCGC values, which range from $\min(\partial SC/\partial \beta_e) \approx -16.4$ to $\max(\partial SC/\partial \beta_e) \approx 1{,}017.8$, with a mean of $200.4$ and a median of $143.3$. 
Most edges exhibit positive SCGC values, indicating that increasing travel times on these links would negatively affect overall network performance. 
These edges largely overlap with the high-utilization corridors identified earlier, underscoring their central role in supporting efficient mobility.\\

In contrast, we identify only 2 Braess edges, with a total length of 1.5\,km. 
These links have negative SCGC values, meaning that increasing their free-flow travel times could paradoxically improve total network performance. 

In contrast to the Cologne case (see~\cref{sec:football-cologne}), where demand and supply are highly asymmetric, a more balanced spatial distribution of origins and destinations substantially reduces the likelihood of Braess edges emerging. When flows are dispersed more evenly across the network, the structural conditions that give rise to paradoxical effects become less pronounced.

While many of these edges exhibit relatively low utilization, it is their low or even negative SCGC values, rather than low flow alone, that identify them as non-critical for overall system efficiency. In other words, their marginal contribution to total social cost is small or beneficial when reduced. Such links therefore provide strategic flexibility for targeted interventions, including speed limit reductions, lane reallocation to cycling or bus infrastructure, or temporary closures during peak periods, without compromising aggregate network performance.
\\

This case study illustrates how combining utilization and SCGC analysis provides a more complete picture of network structure and function. 
High-SCGC and high-utilization corridors form the operational backbone of the system and should be protected to maintain stable traffic flow. 
Conversely, edges with low or negative SCGC values represent promising candidates for mode shift or other interventions that can promote more sustainable mobility without sacrificing efficiency. 
Potsdam’s network structure thus reveals both clear operational priorities and opportunities for targeted, low-impact interventions.
The cross-city intervention-ranking validation is provided in Appendix~\ref{app:intervention-validation}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage

\section{Discussion and Conclusion}\label{sec:discussion}

This study proposed \emph{social cost gradient centrality} (SCGC), a novel sensitivity-based graph centrality for identifying critical and paradoxical edges in transportation networks. By linking marginal changes in link-level free-flow travel times to total social cost, SCGC provides a direct measure of how local infrastructure characteristics influence global network performance. Unlike traditional topological centrality measures, SCGC is grounded in the equilibrium flow structure of the network and reflects the emergent properties of self-organized traffic states.

\subsection{Interpretation and implications}

The results demonstrate that not all links contribute equally to system performance. A relatively small subset of edges exerts a disproportionately large influence on the overall social cost, highlighting their structural and functional centrality. Positive SCGC values indicate critical links whose degradation would significantly increase travel times, whereas negative values reveal Braessian edges where capacity expansion or travel time reductions would paradoxically worsen overall network efficiency. This provides a powerful diagnostic lens for understanding how local perturbations propagate through a self-organizing system.

From a conceptual standpoint, these findings align with the view of transport networks as complex adaptive systems and with Haken’s principles of synergetics, where global order emerges from the interplay of a few dominant structures and many interacting components~\cite{haken1983}. In this perspective, edges with high SCGC values can be interpreted as effective `order parameters' that shape macroscopic flow patterns. SCGC captures this local--global coupling by quantifying how infinitesimal link-level interventions affect system-wide performance.

A key implication is that SCGC extends conventional edge ranking beyond purely structural notions of importance. Metrics based only on topology or observed flow volumes may identify heavily used corridors, but they do not directly quantify the marginal system-level consequence of changing a link attribute. SCGC closes this gap by linking each edge to a directional sensitivity: it indicates not only whether an edge matters, but also whether local improvement is expected to help or harm global efficiency under equilibrium behavior.

At the same time, SCGC should be interpreted as a local response measure around the current operating point. Its value is strongest when used as a differential indicator that complements scenario-based planning, rather than replacing it. In practical terms, SCGC can prioritize where detailed simulations or intervention studies should be concentrated, thereby reducing the search space for policy design in large urban networks.
This empirical usefulness is supported by the cross-city intervention validation (Appendix~\ref{app:intervention-validation}): across 42 tested budget points, SCGC ranking is best in 100\% of cases and attains substantially higher one-edge rank correlation with realized impact than flow or betweenness baselines.
Interpreted as a binomial proportion, this 42/42 win record corresponds to an exact 95\% confidence interval of approximately $[91.6\%, 100\%]$.
Put simply, when we perturb the top-ranked roads by the same small amount, the SCGC-ranked set consistently produces the largest realized deterioration in total network performance, confirming that SCGC better captures true marginal criticality.

\subsection{Policy relevance}

For urban mobility planning, the implications are twofold. First, the identification of critical edges enables targeted investment in infrastructure maintenance or enhancement where it has the greatest systemic benefit. Second, the detection of Braessian edges provides an analytical foundation for demand management, road space reallocation, or capacity reduction strategies that can improve overall efficiency despite appearing counterintuitive from a local perspective. These insights support the shift away from car-centric expansion strategies toward more intelligent network management and demand-side regulation.

Moreover, SCGC offers a quantitative tool for prioritizing measures such as congestion pricing, access restrictions, or adaptive signal control. By focusing on links with the strongest impact on total social cost, policymakers can implement targeted and cost-effective interventions, avoiding broad and inefficient measures that overlook the network’s self-organizing structure.

From an implementation perspective, SCGC can support a staged decision workflow: first, compute a citywide sensitivity map to identify candidate links; second, perform robustness checks under alternative demand snapshots and operational assumptions; third, test selected interventions in pilot corridors before network-wide rollout. This progression combines computational tractability with policy caution and helps avoid expensive interventions on links with low systemic leverage.

Importantly, the presence of Braessian links does not imply that every capacity reduction is beneficial. Rather, it highlights where local changes warrant closer evaluation because network feedbacks are non-intuitive. In this sense, SCGC contributes to evidence-based governance by making such feedbacks measurable and transparent.

\subsection{Limitations and future work}

While the current formulation provides a clear analytical foundation, several important limitations remain. A key restriction arises from the fact that SCGC exploits the piecewise linearity of total social cost with respect to free-flow travel times, which is inherent to the underlying linear link cost functions and static equilibrium formulation. This allows for an elegant and computationally efficient derivation of marginal sensitivities, but it also means that SCGC is strictly valid only within a fixed active-support subgraph (equilibrium) regime. When marginal changes in link attributes lead to discontinuous shifts in route choice patterns or the activation of alternative paths, the derivative structure itself changes. Consequently, SCGC captures local sensitivity around the current equilibrium but does not provide a global picture of how larger interventions might reshape flow distributions and system performance (Appendices~\ref{app:active-set-stability} and~\ref{app:local-breakpoint-predictor}).

This limitation is particularly relevant in networks with multiple near-optimal equilibria or where congestion dynamics are dominated by threshold effects. In such settings, even small infrastructure or demand changes can trigger qualitative shifts in traffic patterns that fall outside the linear response captured by SCGC. Future research should address this by extending the method to nonlinear cost functions or by embedding SCGC within dynamic traffic assignment frameworks that explicitly model time-dependent and path-switching behavior.

A second promising direction lies in broadening the scope of SCGC beyond single-layer, single-mode networks. Integrating multimodal and multilayer structures would enable the assessment of resilience and efficiency across more realistic urban mobility systems, where capacity interventions or disruptions can have cascading effects across modes.

Finally, coupling SCGC with control or optimization approaches represents a powerful avenue for policy applications. By identifying the links with the highest marginal impact, SCGC could inform targeted road pricing, capacity management, or resilience strategies. Extending the concept to capture higher-order interactions between edges, such as pairwise or groupwise sensitivities, would further enhance its ability to reveal the structural mechanisms through which local interventions propagate through complex transport networks.

Further limitations concern data and model calibration. In real-world deployments, uncertainties in speed limits, lane counts, demand estimation, and network simplification steps can propagate into $\alpha_e$, $\beta_e$, and OD matrices, thereby affecting SCGC rankings. Systematic uncertainty quantification, including confidence intervals for edge sensitivities, is therefore an important extension for operational use.

A related direction is temporal and behavioral heterogeneity. The present static equilibrium perspective does not explicitly resolve peak spreading, departure-time choice, incident response, or adaptive traveler learning. Incorporating these effects in dynamic or stochastic formulations would improve realism and clarify how stable SCGC rankings remain across daily and seasonal variability.



\subsection{Conclusion}

This work advances the understanding of how local infrastructure characteristics shape global network behavior in self-organizing transport systems. SCGC provides a simple yet powerful tool to identify edges with disproportionate systemic importance, encompassing both critical and paradoxical effects. By grounding edge importance in network flows and social costs, this measure offers actionable insights for infrastructure planning, demand management, and policy design.

Methodologically, the contribution is twofold: a tractable analytical sensitivity framework for equilibrium traffic assignment under linear costs, and a centrality interpretation that connects marginal link perturbations to system-wide efficiency outcomes. Empirically, applications to synthetic and real-world networks show that SCGC can separate structurally important corridors from links that are operationally flexible, including rare but policy-relevant Braessian edges.

For practitioners, SCGC is most valuable as a prioritization layer: it identifies where limited planning and investment capacity is likely to yield the largest system-level effects, and where conventional intuition about `improvements' may fail. For research, it opens a path toward sensitivity-based control of mobility systems that combines equilibrium theory, network science, and decision support.

SCGC operationalizes Haken's insight that global order in complex systems arises from local interactions and a few dominant components. More broadly, it demonstrates how sensitivity analysis can bridge microscopic infrastructure attributes and macroscopic system performance, contributing to the broader study of self-organization and control in complex networks.


\newpage
\appendix
\section{Link--path to node--link formulation}\label{app:link-path-node}
The traffic assignment problem (TAP) captures this behavior. Following~\citep{beckmann1956studies, dafermos1969traffic, dafermos1980traffic}, it can be formalized as an optimization problem
\begin{align}\label{eq:app-tap-link-path}
    \min_{{f_e}} \sum_{e \in E} \mathcal{F}(f_e) &, \nonumber \\
   \text{subject to } \sum_{r\in R^w} f_r^w &= d^w, \quad \forall w\in W, \nonumber \\
    f_r^w &\geq 0, \quad \forall r \in R^w, w \in W, \nonumber \\
    f_e &= \sum_{w\in W}\sum_{r\in R^w}\Delta_{e,r}^w f_r^w, 
\end{align}
where $f_e$ describes the flow on edge $e$, while $f_r^w$ describes the flow on path $r \in R$ between origin--destination tuple (OD) $w \in W$, such that demand $d^w$ is satisfied. Moreover, we define the link--path incidence matrix $\Delta^w_{e,r}$, which is equal to one if edge $e$ lies on path $r$ for OD tuple $w$, and zero otherwise:
\begin{align}
\Delta^w_{e,r} = 
    \begin{cases}
        1, \text{ if edge $e$ is on path $r \in R^w$ of OD tuple $w$,}\\
        0, \text{ otherwise.}
    \end{cases}
\end{align}


For the linear-cost model used in this paper (see Eq.~\ref{eq:linear-travel-time}), the user-equilibrium objective is
\begin{align}
    \mathcal{F}_{\text{ue}}(f_e)=\frac{1}{2}\alpha_e f_e^2+\beta_e f_e.
\end{align}
The objective function for the system optimum of the TAP is given by the total travel time experienced by all drivers (i.e., the social cost), given by
 \begin{align}
     \mathcal{F}_{\text{so}}(f_e) = f_e t_e.
 \end{align}
Both objective functions are convex on the domain $[0, f_e^{\max}]$. Hence, the optimization problem~\eqref{eq:app-tap-link-path} can be solved in principle in polynomial time~\citep{kozlov1979polynomial}.
This formulation of the TAP is referred to as the \textit{link-path} formulation, as it requires the calculation of all paths from all origin-destination pairs. However, the number of possible paths between an origin and a destination generally increases rapidly (often exponentially) with graph size, making this formulation impractical for large urban networks.\\


To overcome the issue of having to compute all possible paths for a origin-destination pair, an alternative approach is to reformulate the TAP in a \textit{node-link} formulation. This can be achieved by defining the node-edge incidence matrix of a graph as 
\begin{align}\label{eq:app-edge-incidence}
    E_{ne} = 
    \begin{cases} 
    1 & \text{if edge } e \text{ originates at node } n, \\
    -1 & \text{if edge } e \text{ terminates at node } n, \\
    0 & \text{otherwise}.
    \end{cases}
\end{align}
Then, we can write down the TAP in the following way:
\begin{align}\label{eq:app-tap-node-link}
    \min_{{f_e}} \sum_{e \in E} \mathcal{F}(f_e) &, \nonumber \\
   \text{subject to } \sum_{e \in E} E_{ne}f^w_e &= p_n^w, \quad \forall n \in V, w \in W \nonumber \\
   f^w_e &\geq 0, \quad \forall e \in E, w \in W \nonumber,\\
   f_e &= \sum_{w\in W} f_e^w \quad \forall e \in E.
\end{align}
with 
\begin{align}
    \mathcal{F}(f_e) = \frac{1}{2}\alpha_e f_e^2 + \beta_e f_e.
\end{align}
where
\begin{equation}
    \begin{split}
    &p^w_n = \\
    &\begin{cases}
        d^w, & \text{ if node $n$ is the origin in a OD tuple $w$},\\
        -d^w, & \text{ if node $n$ is the destination in a OD tuple $w$},\\
        0, &\text{ otherwise}.
    \end{cases}   
\end{split}
\end{equation}
We will refer to the vector $\vec{p}^{\,w}$ with the elements $p^w_i, i \in V$ as source-sink vector.

\begin{lemma}[Equivalence of link-path and node-link constraints]
The constraints of the link-path formulation of the Traffic Assignment Problem (TAP) in Equation~\ref{eq:app-tap-link-path} can be equivalently transformed into the constraints of the node-link formulation of TAP in Equation~\ref{eq:app-tap-node-link}.
\end{lemma}
\begin{proof}
For one OD pair $w=(o,d)$, define edge flows induced by path flows as
\begin{align}
f_e^w=\sum_{r\in R^w}\Delta_{e,r}^w f_r^w,
\qquad
f_e=\sum_{w\in W}f_e^w.
\end{align}
Applying the node-edge incidence matrix to $f^w$ gives
\begin{align}
\sum_{e\in E}E_{ne}f_e^w
=\sum_{r\in R^w}\left(\sum_{e\in E}E_{ne}\Delta_{e,r}^w\right)f_r^w.
\end{align}
For any path $r\in R^w$, the inner sum equals $+1$ at the origin node $o$, $-1$ at the destination node $d$, and $0$ elsewhere. Therefore
\begin{align}
\sum_{e\in E}E_{ne}f_e^w
=
\begin{cases}
\sum_{r\in R^w}f_r^w, & n=o,\\
-\sum_{r\in R^w}f_r^w, & n=d,\\
0, & \text{otherwise}.
\end{cases}
\end{align}
Using the link-path demand constraint $\sum_{r\in R^w}f_r^w=d^w$, we obtain
\begin{align}
\sum_{e\in E}E_{ne}f_e^w
=
\begin{cases}
d^w, & n=o,\\
-d^w, & n=d,\\
0, & \text{otherwise},
\end{cases}
=p_n^w,
\end{align}
which is exactly the node-link flow-conservation constraint.
The non-negativity constraints are preserved directly, since $f_r^w\ge 0$ implies $f_e^w\ge 0$ by construction.
\end{proof}
\begin{lemma}[Flow decomposition theorem~\citep{ahuja1995network, krylatov2020optimization}]
    Every route flow $f_r$ has a unique representation as non-negative link flows $f_e$. Conversely, every non-negative link flow can be represented by route flows, though this representation need not be unique.
\end{lemma}

\section{Active-set stability under local $\beta$-perturbations}\label{app:active-set-stability}
To quantify the practical validity range of the fixed active-support subgraph assumption used by SCGC, we perform an active-set stability scan on a synthetic planar network. Starting from a baseline user equilibrium, we perturb one edge free-flow parameter $\beta_k$ at a time and recompute the multicommodity equilibrium. We then compare the resulting active set to the baseline active set.

In the experiment shown in \cref{fig:app-active-set-stability}, we use a synthetic network with 50 nodes and evaluate perturbations in the range $\Delta \beta_k/\beta_k \in [-5\%, 5\%]$ for a selected set of high-flow edges. Panel (a) reports, for each perturbed edge and perturbation level, the number of active-set entries that differ from baseline. Panel (b) summarizes two stability indicators over all tested edges: the exact stable fraction (black) and the mean Jaccard overlap of active sets (blue dashed).

Let $\mathcal{A}_0$ denote the baseline active set and $\mathcal{A}_{k,\delta}$ the active set after perturbing edge $k$ by relative amount $\delta$. The Jaccard similarity is computed as
\begin{equation}
J(\mathcal{A}_0,\mathcal{A}_{k,\delta})=\frac{|\mathcal{A}_0\cap \mathcal{A}_{k,\delta}|}{|\mathcal{A}_0\cup \mathcal{A}_{k,\delta}|}.
\end{equation}
Thus, $J=1$ indicates exact equality of active sets, while $J<1$ indicates structural changes.

The results show that active-set stability is highest close to $\Delta\beta_k=0$, where the exact stable fraction is 1 and the Jaccard similarity is exactly 1 for all tested edges. At the perturbation bounds, the mean Jaccard values remain high ($\bar J\approx 0.9978$ at $-5\%$ and $\bar J\approx 0.9983$ at $+5\%$), even though exact stability drops (stable fraction $\approx 0.55$ at $-5\%$). The global minimum over all tested edge--perturbation pairs is $J_{\min}\approx 0.9855$, observed for edge $(13,46)$ at $-5\%$, corresponding to 6 changed active-set entries out of 414 baseline active entries. The global maximum is $J_{\max}=1$, attained at $\delta=0$ (and also at several nonzero perturbations for robust edges). For this benchmark, the median local stability radius is approximately $3.5\%$, supporting the interpretation of SCGC as a local sensitivity measure that is reliable for small perturbations and should be complemented by full re-equilibration for larger interventions.

\begin{figure}[t]
\centering
\includegraphics[width=\columnwidth]{assets/active-set-stability-synthetic.pdf}
\caption{Active-set stability under edge-wise perturbations of free-flow travel time. \textbf{(a)} Number of active-set entries that differ from the baseline active set when perturbing one edge parameter $\beta_k$ at a time. \textbf{(b)} Aggregate stability metrics across tested edges: exact stable fraction (black) and mean Jaccard similarity (blue dashed). The annotation reports the median local perturbation radius around zero for which exact active-set identity is preserved.}
\label{fig:app-active-set-stability}
\end{figure}


\section{Local first-breakpoint predictor}\label{app:local-breakpoint-predictor}
This appendix formalizes the local predictor used to estimate when a perturbation of one edge parameter $\beta_k$ first changes the active set.
We denote by $f_i$ the commodity-edge flow entries (stacked over tuples and edges), and by
\begin{equation}
s_i = \alpha_{e(i)} F_{e(i)} + \beta_{e(i)} - (\mathcal{E}^{\!\top}\lambda)_i
\end{equation}
the corresponding complementarity slack, where $F_{e(i)}=\sum_w f^w_{e(i)}$ is total flow on physical edge $e(i)$.
At baseline, active entries satisfy $f_i^0>\varepsilon_{\mathrm{act}}$ and (up to tolerance) $s_i^0=0$, while inactive entries satisfy $f_i^0\approx 0$ and $s_i^0>0$.

For a perturbation on one edge, $\beta_k=\beta_k^0+\eta$, and fixed active set, the reduced KKT system gives first-order responses
\begin{equation}
f_i(\eta)=f_i^0+\dot f_i\,\eta+o(\eta),\qquad
s_i(\eta)=s_i^0+\dot s_i\,\eta+o(\eta).
\end{equation}
Candidate breakpoints are where either an active flow hits the activity threshold or an inactive slack hits zero.
For the positive direction ($\eta>0$), these candidates are
\begin{align}
\eta^{+,\mathrm{leave}}_i &= \frac{\varepsilon_{\mathrm{act}}-f_i^0}{\dot f_i}
\quad\text{for active }i\text{ with }\dot f_i<0,\\
\eta^{+,\mathrm{enter}}_j &= -\frac{s_j^0}{\dot s_j}
\quad\text{for inactive }j\text{ with }\dot s_j<0.
\end{align}
Analogously, for the negative direction ($\eta<0$), candidate magnitudes are
\begin{align}
\eta^{-,\mathrm{leave}}_i &= -\frac{\varepsilon_{\mathrm{act}}-f_i^0}{\dot f_i}
\quad\text{for active }i\text{ with }\dot f_i>0,\\
\eta^{-,\mathrm{enter}}_j &= \frac{s_j^0}{\dot s_j}
\quad\text{for inactive }j\text{ with }\dot s_j>0.
\end{align}
The predicted directional first breakpoints are the smallest positive candidates,
\begin{align}
\hat\eta_k^+ &= \min\!\left(\eta^{+,\mathrm{leave}}_i,\eta^{+,\mathrm{enter}}_j\right),\\
\hat\eta_k^- &= \min\!\left(\eta^{-,\mathrm{leave}}_i,\eta^{-,\mathrm{enter}}_j\right),
\end{align}
and the predicted symmetric local radius is
\begin{equation}
\hat r_k=\frac{1}{\beta_k^0}\min(\hat\eta_k^+,\hat\eta_k^-).
\end{equation}

The observed directional radii are obtained by repeated full equilibrium solves and active-set comparison:
\begin{equation}
r_{k,\pm}^{\mathrm{obs}}=\sup\{r\ge 0:\mathcal{A}_{k,\pm}(\rho)=\mathcal{A}_0\ \forall \rho\in[0,r]\},
\end{equation}
with $\beta_k=\beta_k^0(1\pm \rho)$.

\cref{fig:app-linear-predictor-transfer} compares predicted and observed radii across graph families and demand/beta regimes.
The concentration around the diagonal in some regimes indicates local usefulness, while the broad scatter away from the diagonal in others confirms that this first-order predictor should be interpreted as a local heuristic, not a globally reliable extrapolator.

\begin{figure}[htbp]
\centering
\includegraphics[width=\columnwidth]{assets/linear-predictor-transfer.pdf}
\caption{Transfer test of the raw local linear first-breakpoint predictor. Each point corresponds to one edge-direction sample; color indicates graph family and marker indicates demand/beta regime. The dashed line marks perfect agreement ($\hat r=r^{\mathrm{obs}}$). Deviations from the diagonal quantify mismatch between local linear prediction and observed active-set stability radius.}
\label{fig:app-linear-predictor-transfer}
\end{figure}


\section{Intervention-ranking validation across real-world cases}\label{app:intervention-validation}
To validate whether SCGC-based ranking predicts realized intervention impact beyond a single network, we run the same stress-test protocol on two distinct real-world cases: event-driven traffic in Cologne and daily urban traffic in Potsdam, each evaluated under three demand multipliers.
Starting from each calibrated baseline equilibrium, we define a candidate set $C$ as the top-flow edges (Cologne: up to 60 candidates, Potsdam: up to 25 candidates). For each ranking method and budget $k$, we select the top-$k$ edges from $C$ and apply a positive perturbation to free-flow travel times:
\begin{equation}
\beta_e'=\beta_e(1+\rho), \qquad \rho=0.01.
\end{equation}
For each method $m\in\{$SCGC, flow, betweenness, random$\}$ and budget $k$, we choose a set $S_k^{(m)}$ of $k$ edges according to the method ranking and recompute the full multicommodity equilibrium.
The realized impact is measured as
\begin{equation}
\Delta SC\!\left(S_k^{(m)}\right)=100\cdot\frac{SC(\beta')-SC(\beta)}{SC(\beta)}.
\end{equation}
Higher values indicate that the selected edges are more critical (larger system damage under the same perturbation budget). For the random baseline, we average over repeated random top-$k$ selections (20 repeats in Cologne, 16 in Potsdam).

For SCGC, the local predicted single-edge impact is
\begin{equation}
\widehat{\Delta SC}_e=\frac{\partial SC}{\partial \beta_e}\,\Delta\beta_e,
\end{equation}
with $\Delta\beta_e=\rho\beta_e$ in the stress-test setting.
We then compare this first-order ranking to realized one-edge impacts and to multi-edge top-$k$ outcomes.

Across all tested real-world budgets and demand levels (42 budget points in total, i.e., $3\times(8+6)$ from Cologne budgets $k=1,\dots,8$ and Potsdam budgets $k=1,\dots,6$), SCGC attains a strict 100\% budget-wise win rate over flow, betweenness, and random baselines (exact binomial 95\% CI for the win share: $[91.6\%,100\%]$).
Pooling both cities and all demand multipliers, the mean realized social-cost increase is 0.0219\% for SCGC (95\% bootstrap CI: 0.0180--0.0259), compared with 0.0164\% for flow (0.0133--0.0199), 0.0092\% for betweenness (0.0078--0.0106), and 0.0091\% for random (0.0070--0.0113). The mean SCGC--flow gap is 0.0054 percentage points (95\% bootstrap CI: 0.0046--0.0063), i.e., a relative gain of about 33\% over flow.
For single-edge perturbations, pooled rank correlation between predicted and observed impact is $\rho\approx0.995$ for SCGC (95\% bootstrap CI: 0.989--0.999), versus $\rho\approx0.578$ for flow (0.543--0.609) and $\rho\approx0.041$ for betweenness (-0.011--0.088).
These results support the claim that SCGC captures marginal system sensitivity more faithfully than topology-only or flow-only baselines across heterogeneous urban operating conditions.

\begin{table}[htbp]
\centering
\caption{Intervention-validation summary pooled across Cologne and Potsdam over all tested demand multipliers.}
\begin{tabular}{lcc}
\hline
Method & Mean realized $\Delta SC$ [\%] & Mean Spearman $\rho$ \\
\hline
SCGC-linear & 0.0219 & 0.995 \\
Flow & 0.0164 & 0.578 \\
Betweenness & 0.0092 & 0.041 \\
Random & 0.0091 & -- \\
\hline
\end{tabular}
\label{tab:app-intervention-validation}
\end{table}

\begin{figure}[htbp]
\centering
\includegraphics[width=\columnwidth]{assets/cologne-stadium-intervention-validation.pdf}
\caption{Case-level intervention curves for Cologne: realized social-cost change $\Delta SC$ under $+1\%$ perturbations of selected $\beta_e$ values as a function of intervention budget $k$. Curves show median performance across demand multipliers; shaded bands indicate interquartile ranges.}
\label{fig:app-intervention-validation-cologne}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=\columnwidth]{assets/potsdam-intervention-validation.pdf}
\caption{Case-level intervention curves for Potsdam, using the same protocol as in Cologne. SCGC remains the best-performing ranking across all tested budgets and demand multipliers.}
\label{fig:app-intervention-validation-potsdam}
\end{figure}


\section{Constructing real-world networks}\label{sec:generate_graphs}
We construct directed graphs using road network data from the OpenStreetMap (OSM) project, leveraging the Python package OSMnx~\cite{boeing2025modeling}. OSM provides detailed geographical and infrastructural information about roads in a specified region, including their location, length, speed limit, number of lanes, and other metadata.\\

Real-world graph networks can become very large. For example, consider Berlin, the largest city in Germany: its road network comprises $N = 5{,}711$ nodes and $M = 11{,}882$ edges. If every node were allowed to act as an origin in the traffic assignment problem (TAP), i.e., $|W| = 5{,}711$, the resulting system would involve $5{,}711 \times 11{,}882$ flow variables and $5{,}711 \times 5{,}711$ constraints. Solving such a system directly is computationally infeasible.\\

To address this challenge, we apply a series of spatial and topological simplification steps that preserve the essential structure of the network while making the problem tractable.\\

First, we exclude minor roads, in particular residential streets, which contribute little to large-scale traffic flow but significantly increase network size and complexity. This step effectively filters the graph to include only major road classes such as motorways, trunk roads, and primary or secondary streets.\\

Second, we use the \texttt{osmnx.simplification.consolidate\_intersections} function to merge nearby nodes representing the same physical intersection. Divided roads, roundabouts, or complex intersections are often represented in OSM by multiple closely spaced nodes, which unnecessarily inflate the number of variables and constraints in the TAP formulation. Consolidating these nodes reduces network complexity while preserving its essential connectivity and flow structure. The tolerance parameter for node consolidation is set to $100\,\mathrm{m}$, reflecting typical urban intersection spacing.\\

Finally, we restrict the set of destination nodes $W$ to a strategically selected subset that captures the essential travel demand structure. For example, we may consider centroids of administrative districts, major transportation hubs, or points of interest such as football stadiums. By focusing on a representative set of destinations rather than the full node set, we drastically reduce the dimensionality of the problem while retaining meaningful large-scale flow patterns.\\

These preprocessing steps yield a simplified yet topologically representative network, enabling efficient computation of user equilibrium flows on real-world road networks without sacrificing key structural characteristics.


\section{Accessing the cost function}\label{sec:osm-cost-func}
To compute the cost function (see \cref{eq:linear-travel-time}), we infer the parameters $\alpha_e$ and $\beta_e$ for each road segment $e \in E$. These parameters are derived directly from the physical and infrastructural characteristics of the road network obtained from OpenStreetMap.\\

The free-flow travel time $\beta_e$ is determined from the length $l_e$ of the road segment and its speed limit $v_e$, ensuring that baseline travel times reflect realistic traffic conditions under uncongested flow:
\begin{align*}
    \beta_e = \frac{l_e}{v_e}.
\end{align*}

To represent congestion effects, we compute the congestion factor $\alpha_e$ using the road length, speed limit, and number of lanes $m_e$. Additionally, we define the edge capacity $x^{\max}_e$ and the maximum travel time $t^{\max}_e$ based on a reference walking speed, which acts as an upper bound in extreme congestion scenarios.\\

The congestion factor $\alpha_e$ is given by
\begin{align*}
    \alpha_e = \frac{t^{\max}_e - \beta_e}{5\,x^{\max}_e},
\end{align*}
where $t^{\max}_e = \frac{l_e}{v_{\mathrm{walk}}}$ represents the travel time at walking speed and $x^{\max}_e$ is the effective capacity of the road segment. The scaling factor $5$ controls the slope of the cost function and can be tuned to adjust how quickly travel times increase with flow.



\section{Constructing the OD matrix}\label{sec:od-matrix}
To generate the OD matrix $p_n^w$, we use the population distribution of the region under study. Specifically, we rely on the Global Human Settlement Layer (GHSL)~\cite{GHSL2023} to assign a population count to each node in the network. This is achieved by computing Voronoi polygons around the nodes and intersecting them with the GHSL raster, allowing us to allocate population values proportionally to their spatial influence area (see~\citep{wassmer2024resilience, wassmer2025unveiling} for a detailed explanation of this process).\\

Based on these node-level population values, we assume that the likelihood of trips originating from or traveling to a node is solely determined by its population. As a result, the probability of traveling from one node to another is independent of the distance between them. While more sophisticated approaches could incorporate distance-based effects, such as a gravity model, this simplification is justified by the typical spatial scale of our networks (urban areas), where trip length distributions are relatively homogeneous and distance effects are less pronounced.\\

The OD matrix is generated by distributing a fixed fraction $\gamma$ of each node’s population across a selected set of destination nodes in proportion to their population. This results in
\begin{align*}
    p_n^w = \gamma \, \frac{P_w}{\sum_{w' \in W} P_{w'}} P_n,
\end{align*}
where $P_n$ denotes the population at origin node $n$ and $P_w$ the population at destination node $w$. 








\bibliography{references}
\end{document}
